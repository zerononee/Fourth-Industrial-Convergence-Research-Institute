---
title: "산업연관분석"
date: "`r format(Sys.Date())`"
output:
  html_document:
    fig_height: 6
    fig_width: 10
    highlight: textmate
    toc: yes
    toc_depth: 3
    toc_float: yes
  pdf_document:
    fig_height: 6
    fig_width: 10
    toc: no
  word_document:
    fig_height: 6
    fig_width: 9
    toc: no
---

```{r include=FALSE}
# 기존 데이터셋 삭제
rm(list=ls()) #Removes all items in Environment!
```

# I. 산업연관표 구성 {.tabset .tabset-fade}  
## I.1. 내생부문 생성  
```{r}
내생부문<-matrix(c(1842,25440,3167,8522,359803,114617,4023,85978,189892), nrow=3, ncol=3, byrow=T)
print(내생부문)
print(dim(내생부문))
```

## I.2. 산업이름 지정
```{r}
sec_names <- c("농업","제조업","서비스업")
rownames(내생부문) <- sec_names
colnames(내생부문) <- sec_names
print(내생부문)
```

## I.3. 부가가치계 생성
```{r}
부가가치계<-matrix(c(23900,178772,396973), nrow=3)
rownames(부가가치계) <- sec_names
colnames(부가가치계) <- c("부가가치계")
부가가치계=t(부가가치계)
print(dim(부가가치계))
print(부가가치계)
```

## I.4. 고용자수 생성
```{r}
고용자수<-matrix(c(3705,29104,138584), nrow=3)
rownames(고용자수) <- sec_names
colnames(고용자수) <- c("고용자수")
고용자수=t(고용자수)
print(dim(고용자수))
print(고용자수)
```

## I.5. 총투입물 생성
```{r}
총투입물<-matrix(c(38287,649993,704649), nrow=3)
dim(총투입물)
rownames(총투입물) <- sec_names
colnames(총투입물) <- c("총투입물")
총투입물=t(총투입물)
print(dim(총투입물))
print(총투입물)
```

## I.6. 최종수요 생성
```{r}
최종수요<-matrix(c(783800000000,16705100000000,42475600000000), nrow=3)
print(최종수요)
rownames(최종수요) <- sec_names
colnames(최종수요) <- c("최종수요")
print(최종수요)
```

## I.7. 산업연관표 생성
```{r}
input=rbind(내생부문,부가가치계,총투입물)
총생산물=t(총투입물)
colnames(총생산물) <- c("총생산물")
output=cbind(내생부문,최종수요,총생산물)
output


산업연관표<-list(output,부가가치계,고용자수)
산업연관표
```

# II. 산업연관분석 준비 {.tabset .tabset-fade}
## II.1. 투입계수(A)행렬 생성 

총투입물확장행렬 = rep(총투입물,n=산업의수)
```{r}
A_mat <- sweep(내생부문,2, 총투입물, '/')
A_mat
```

## II.2. 부가가치계계수 생성
```{r}
부가가치계계수=부가가치계/총투입물
부가가치계계수
```

## II.3. 고용자수계수 생성
```{r}
고용자수계수=고용자수/총투입물
고용자수계수
```

## II.4. 생산유발승수 생성  

I-A의 역행렬: 생산유발계수
```{r}
I=diag(nrow(A_mat)) # 단위행렬
IminusA_reverse = solve(I-A_mat)
dim(IminusA_reverse)
생산유발승수행렬<-IminusA_reverse
생산유발승수행렬
```
  
생산승수: 생산유발계수행렬의 열합
```{r}
생산유발승수=colSums(생산유발승수행렬) 
생산유발승수
```

## II.5. 각종계수와 생산유발승수  
```{r}
basic_list<-list(A_mat,부가가치계계수,고용자수계수,생산유발승수행렬,생산유발승수)
names(basic_list) <- c("투입계수","부가가치계계수","고용자수계수","생산유발승수행렬","생산유발승수")
basic_list
```

## II.6. 부가가치계유발승수행렬과 승수
```{r}
부가가치계유발승수행렬<-생산유발승수행렬%*%diag(as.numeric(부가가치계계수)) # %*%: 행렬곱
부가가치계유발승수=colSums(부가가치계유발승수행렬) # 생산승수: 생산유발계수행렬의 열합
value_list<-list(부가가치계유발승수행렬,부가가치계유발승수)
names(value_list) <- c("부가가치계유발승수행렬","부가가치계유발승수")
value_list
```

## II.7. 고용자수유발승수행렬과 승수
```{r}
고용자수유발승수행렬<-생산유발승수행렬%*%diag(as.numeric(고용자수계수)) # %*%: 행렬곱
고용자수유발승수=colSums(고용자수유발승수행렬) # 생산승수: 생산유발계수행렬의 열합
labor_list<-list(고용자수유발승수행렬,고용자수유발승수)
names(labor_list) <- c("고용자수유발승수행렬","고용자수유발승수")
labor_list
```

## II.8. 외부효과 정의
```{r}
외부효과<-matrix(c(0,0,560000000), nrow=3)
print(외부효과)
rownames(외부효과) <- sec_names
colnames(외부효과) <- c("외부효과")
print(외부효과)
```

# III. 산업연관분석 {.tabset .tabset-fade}
## III.1. 부문별 생산유발효과
```{r}
생파효과_부문<-생산유발승수행렬%*%diag(as.numeric(외부효과))/100000000 # 억원 환산
생파효과_부문_증가<-생산유발승수행렬%*%diag(as.numeric(1.5*외부효과))/100000000 # 억원 환산
생파효과_부문_list<-list(외부효과,생파효과_부문,생파효과_부문_증가,(생파효과_부문-생파효과_부문_증가))
생파효과_전체_list<-rbind(t(rowSums(생파효과_부문)),t(rowSums(생파효과_부문_증가)),t(rowSums(생파효과_부문-생파효과_부문_증가)))
생파효과_전체_list=t(생파효과_전체_list)
생파효과_전체_전체<-cbind(sum(rowSums(생파효과_부문)),sum(rowSums(생파효과_부문_증가)),sum(rowSums(생파효과_부문-생파효과_부문_증가)))
names(생파효과_부문_list)<- c("외부효과","외부효과생파효과_부문","테스트외부효과생파효과_부문","외부효과변화생파효과_부문")
colnames(생파효과_전체_list)<- c("외부효과생파효과_전체","테스트외부효과생파효과_전체","외부효과변화생파효과_전체")
colnames(생파효과_전체_전체)<-  c("외부효과","테스트외부효과","외부효과변화")
rownames(생파효과_전체_전체)<- c("생파효과_전체_전체")
print(생파효과_부문_list)
print(생파효과_전체_list)
print(생파효과_전체_전체)
```

## III.2. 부문별 부가가치계유발효과
```{r}
부파효과_부문<-부가가치계유발승수행렬%*%diag(as.numeric(외부효과))/100000000 # 억원 환산
부파효과_부문_증가<-부가가치계유발승수행렬%*%diag(as.numeric(1.5*외부효과))/100000000 # 억원 환산
부파효과_부문_list<-list(외부효과,부파효과_부문,부파효과_부문_증가,(부파효과_부문-부파효과_부문_증가))
부파효과_전체_list<-rbind(t(rowSums(부파효과_부문)),t(rowSums(부파효과_부문_증가)),t(rowSums(부파효과_부문-부파효과_부문_증가)))
부파효과_전체_list=t(부파효과_전체_list)
부파효과_전체_전체<-cbind(sum(rowSums(부파효과_부문)),sum(rowSums(부파효과_부문_증가)),sum(rowSums(부파효과_부문-부파효과_부문_증가)))
names(부파효과_부문_list)<- c("외부효과","외부효과부파효과_부문","테스트외부효과부파효과_부문","외부효과변화부파효과_부문")
colnames(부파효과_전체_list)<- c("외부효과부파효과_전체","테스트외부효과부파효과_전체","외부효과변화부파효과_전체")
colnames(부파효과_전체_전체)<-  c("외부효과","테스트외부효과","외부효과변화")
rownames(부파효과_전체_전체)<- c("부파효과_전체_전체")
print(부파효과_부문_list)
print(부파효과_전체_list)
print(부파효과_전체_전체)
```

## III.3. 부문별 고용자수유발효과
```{r}
고파효과_부문<-고용자수유발승수행렬%*%diag(as.numeric(외부효과))/1000000 # 100당 환산
고파효과_부문_증가<-고용자수유발승수행렬%*%diag(as.numeric(1.5*외부효과))/1000000 # 100당 환산
고파효과_부문_list<-list(외부효과,고파효과_부문,고파효과_부문_증가,(고파효과_부문-고파효과_부문_증가))
고파효과_전체_list<-rbind(t(rowSums(고파효과_부문)),t(rowSums(고파효과_부문_증가)),t(rowSums(고파효과_부문-고파효과_부문_증가)))
고파효과_전체_list=t(고파효과_전체_list)
고파효과_전체_전체<-cbind(sum(rowSums(고파효과_부문)),sum(rowSums(고파효과_부문_증가)),sum(rowSums(고파효과_부문-고파효과_부문_증가)))
names(고파효과_부문_list)<- c("외부효과","외부효과고파효과_부문","테스트외부효과고파효과_부문","외부효과변화고파효과_부문")
colnames(고파효과_전체_list)<- c("외부효과고파효과_전체","테스트외부효과고파효과_전체","외부효과변화고파효과_전체")
colnames(고파효과_전체_전체)<-  c("외부효과","테스트외부효과","외부효과변화")
rownames(고파효과_전체_전체)<- c("고파효과_전체_전체")
print(고파효과_부문_list)
print(고파효과_전체_list)
print(고파효과_전체_전체)
```

## III.4. 경제적파급효과종합
```{r}
경제적파급효과종합_list<-list(생파효과_전체_list,부파효과_전체_list,고파효과_전체_list)
names(경제적파급효과종합_list) <- c("생산파급효과(1+2차)", "부가가치파급효과(1+2차)", "고용자수파급효과(1+2차)")
경제적파급효과종합_list
```


